### osi模型：

应表会传网数物 七层协议模型

Tcp/ip四层概念模型:  应用层、传输层、网络层、数据链路层

应用层需掌握 http\ftp\smtp\pop3\imap4



### 一次http请求过程: 

域名解析dns-》发起TCP的三次握手-〉建立tcp连接后发起http请求-> 服务器响应http请求，浏览器得到html代码->浏览器解析html代码-》页面渲

1.域名解析：以谷歌为例。如果浏览器缓存没有找到-〉去操作系统缓存找-》还没找到会去hosts文件找，如果都没有找到的话。就会向运营商发起DNS解析请求，运营商会先从自身缓存找 没找到的话使用UDP协议向53端口发送请求，请求返回该域名的ip，会依次经过根域、顶级域查找www.xx.com的ip 最终返回ip

2.tcp3次握手:  拿到ip后 user-agent以一个随机端口向服务器的web程序80端口发起tcp连接请求，请求到达服务器端后进入网卡，然后进入内核的tcp/ip协议栈 会将请求一层层剥开，可能会通过防火墙的过滤， 最终到达web程序，最终建立tcp/ip连接

服务器端web程序接受到http请求之后，就开始处理该请求，处理之后返回给浏览器html文件



###负载均衡： 

早期开始使用的是dns分流策略 dns做负载，解析不同的ip给客户端，让客户端的流量直接到达各个服务器，但这个方法的缺点就是延时性，且调度策略简单，满足不来业务需求，因此出现了负载均衡

负载均衡通过一台服务器做负载，通过轮询算法将客户端的流量分给其他服务器，并且对集群中的服务器进行健康检查，如果发现故障节点会动态的将该节点从集群中剔除，以此来保证应用的高可用

负载均衡分四层负载均衡和七层负载均衡，四层指的是osi模型的传输层，负责的是转发，七层指的是应用层 负责代理

反向代理:  传统的代理是服务器位于浏览器一端，代理浏览器将http请求发到互联网上，  而反向代理的服务器是位于网站机房一侧。代理web服务器接受http请求



###百万级数据库优化

1.查询优化

> 1避免全表扫描，对where和order by使用多的字段建索引
>
> 2.索引不能建太多，一张表建议5-6个，过多会对插入和修改引起不必要的麻烦
>
> 3考虑索引是否有必要，避免where语句对字段进行null判断，这样会放弃索引而去全表扫描
>
> 4 尽量使用数值类型而非字符类型，字符长度减少
>
> 5 使用like也会全表查询，可以考虑全文检索

2.数据库优化

> 1、  减少数据访问（减少磁盘访问）
>
> 2、  返回更少数据（减少网络传输或磁盘访问）
>
> 3、  减少交互次数（减少网络传输）
>
> 4、  减少服务器CPU开销（减少CPU及内存开销）
>
> 5、  利用更多资源（增加资源）

Django-orm优化

> 1、  当只获取一两列数据时，把使用values、values_list，它就会返回字典或元组，2⃣而不是python对象
>
> 2、  对获取的数据进行缓存，使用redis，
>
> 3、   处理很多记录。 当你获得一个queryset时，django会缓存这些数据，如果你对查询结果进行多次循环，则这些缓存很有意义，但如果只循环一次，那就很耗费资源了。这个时候可以使用iterator()

```python
for book in Books.objects.all():
    do_stuff(book)
# 修改后
for book in Books.objects.all().iterator():
    do_stuff(book)
```



### csrf：

 跨站请求伪造攻击、通过伪造网站访问请求，使携带cookie信息的用户进行一些危险的操作

###tornado与django优点对比

django：

ORM、内置后台管理系统、session

tornado

异步编程、web sockets、http服务器